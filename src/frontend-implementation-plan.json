{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Version 2: Core Consignment/Accounting Improvements - Frontend Preservation",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Preserve all existing frontend features and ensure compatibility with selected components",
      "acceptanceCriteria": [
        "All existing pages remain functional and accessible",
        "Theme and styling are preserved",
        "All CRUD operations for entities continue to work",
        "Navigation and routing remain intact",
        "User-friendliness features (animations, layout hierarchy, visual theming) are maintained"
      ],
      "file_operations": [
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Verify router configuration includes all existing routes (dashboard, products, reps, consignments, sales, returns, payouts, adjustments, settlement periods, statements) and ensure theme provider and toaster remain wired"
        },
        {
          "path": "frontend/src/components/AppLayout.tsx",
          "operation": "modify",
          "description": "Ensure layout component continues to provide header, navigation tabs, main content area, and footer with proper styling and accessibility"
        },
        {
          "path": "frontend/src/index.css",
          "operation": "modify",
          "description": "Verify Tailwind base styles, theme color tokens (OKLCH), print rules, and global background/foreground styling are preserved"
        },
        {
          "path": "frontend/tailwind.config.js",
          "operation": "modify",
          "description": "Ensure Tailwind configuration maintains theme colors, typography, animations, container settings, and plugins for consistent styling across all pages"
        }
      ]
    },
    {
      "id": "REQ-2",
      "summary": "Preserve onboarding and guided workflow features",
      "acceptanceCriteria": [
        "Users can complete onboarding flows",
        "Guided workflows remain functional",
        "Validation and settlement lock checks continue to work"
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/DashboardPage.tsx",
          "operation": "modify",
          "description": "Verify dashboard displays rep balances and inventory with date filters, CSV export, and commission settings dialog remain functional"
        },
        {
          "path": "frontend/src/components/CommissionSettingsDialog.tsx",
          "operation": "modify",
          "description": "Ensure dialog for viewing and editing default commission rates and per-rep overrides with validation and persistence continues to work"
        },
        {
          "path": "frontend/src/lib/settlementLock.ts",
          "operation": "modify",
          "description": "Verify settlement period lock checks and date validation remain enforced across transaction pages"
        }
      ]
    },
    {
      "id": "REQ-3",
      "summary": "Preserve user personalization and theming capabilities",
      "acceptanceCriteria": [
        "Theme switching works correctly",
        "User preferences are persisted",
        "Visual theming and animations remain captivating"
      ],
      "file_operations": [
        {
          "path": "frontend/src/main.tsx",
          "operation": "modify",
          "description": "Verify React app bootstrapping with React Query and Internet Identity providers (even if auth is not used) remains functional for future extensibility"
        },
        {
          "path": "frontend/src/hooks/useInternetIdentity.ts",
          "operation": "modify",
          "description": "Ensure Internet Identity context and hooks are preserved but remain optional and do not enforce authentication flows"
        }
      ]
    },
    {
      "id": "REQ-4",
      "summary": "Preserve all entity management pages and CRUD operations",
      "acceptanceCriteria": [
        "Products page allows search, creation, listing, and CSV export",
        "Reps page allows management with search, creation, and CSV export",
        "Consignments page supports viewing, filtering, exporting, and adding with settlement lock checks",
        "Sales page lists sales, filters by date, adds sales with line items, and enforces settlement locks",
        "Returns page logs and exports returns with line-item editing and filters",
        "Payouts page records, filters, and exports payouts with validation",
        "Adjustments page lists and creates rep adjustments with validation",
        "Settlement periods page creates and closes periods with date validation",
        "Statements page generates monthly printable statements"
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/ProductsPage.tsx",
          "operation": "modify",
          "description": "Verify product management page with search, creation dialog, listing, and CSV export remains functional"
        },
        {
          "path": "frontend/src/pages/RepsPage.tsx",
          "operation": "modify",
          "description": "Verify reps management page with search, creation dialog, listing, and CSV export including commission data remains functional"
        },
        {
          "path": "frontend/src/pages/ConsignmentsPage.tsx",
          "operation": "modify",
          "description": "Verify consignments page with filtering, CSV export, multi-item entry, and settlement lock checks remains functional"
        },
        {
          "path": "frontend/src/pages/SalesPage.tsx",
          "operation": "modify",
          "description": "Verify sales page with date filtering, line-item entry, CSV export, and settlement-period lock enforcement remains functional"
        },
        {
          "path": "frontend/src/pages/ReturnsPage.tsx",
          "operation": "modify",
          "description": "Verify returns page with line-item editing, date filters, CSV export, and settlement lock enforcement remains functional"
        },
        {
          "path": "frontend/src/pages/PayoutsPage.tsx",
          "operation": "modify",
          "description": "Verify payouts page with recording, filtering, CSV export, validation, and settlement lock checks remains functional"
        },
        {
          "path": "frontend/src/pages/AdjustmentsPage.tsx",
          "operation": "modify",
          "description": "Verify adjustments page with listing, creation dialog, validation, and form submission remains functional"
        },
        {
          "path": "frontend/src/pages/SettlementPeriodsPage.tsx",
          "operation": "modify",
          "description": "Verify settlement periods page with creation, closing, date validation, listing, and transaction locking for closed ranges remains functional"
        },
        {
          "path": "frontend/src/pages/StatementsPage.tsx",
          "operation": "modify",
          "description": "Verify statements page generates monthly printable statements with rep and date range selection, computing balances, commissions, and related transactions"
        }
      ]
    },
    {
      "id": "REQ-5",
      "summary": "Preserve all shared components and utilities",
      "acceptanceCriteria": [
        "Line items editor works for multi-item entry",
        "Product and rep selects load and display correctly",
        "Date range filter allows proper date selection",
        "All hooks continue to fetch and mutate data correctly",
        "Calculation utilities compute balances and inventory accurately",
        "CSV utilities generate and download exports properly"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/LineItemsEditor.tsx",
          "operation": "modify",
          "description": "Verify line items editor for managing product selection, quantity, and optional unit price fields remains functional"
        },
        {
          "path": "frontend/src/components/ProductSelect.tsx",
          "operation": "modify",
          "description": "Verify product dropdown loads and displays products with names and formatted prices correctly"
        },
        {
          "path": "frontend/src/components/RepSelect.tsx",
          "operation": "modify",
          "description": "Verify rep dropdown loads and displays reps by name correctly"
        },
        {
          "path": "frontend/src/components/DateRangeFilter.tsx",
          "operation": "modify",
          "description": "Verify date range selector allows picking, clearing, and applying start/end dates correctly"
        },
        {
          "path": "frontend/src/hooks/useActor.ts",
          "operation": "modify",
          "description": "Verify actor hook creates and manages backend actor and refreshes dependent queries correctly"
        },
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Verify React Query hooks for fetching and mutating all entities (products, reps, consignments, sales, returns, payouts, adjustments, settlement periods) continue to work with the backend interface"
        },
        {
          "path": "frontend/src/lib/calculations.ts",
          "operation": "modify",
          "description": "Verify calculation functions for rep balances and inventory levels using sales, returns, payouts, consignments, and product data remain accurate"
        },
        {
          "path": "frontend/src/lib/commissionSettings.ts",
          "operation": "modify",
          "description": "Verify commission settings management with localStorage including defaults and per-rep overrides continues to work"
        },
        {
          "path": "frontend/src/lib/csv.ts",
          "operation": "modify",
          "description": "Verify CSV generation, downloading utilities, and formatting helpers for dates and currency remain functional"
        },
        {
          "path": "frontend/src/lib/dateUtils.ts",
          "operation": "modify",
          "description": "Verify date utilities for month boundaries, formatting month-year strings, and current month retrieval continue to work"
        }
      ]
    }
  ]
}